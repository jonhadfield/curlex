version: "1.0"

# Example tests demonstrating retry functionality

defaults:
  retries: 2
  retry_delay: "1s"
  retry_backoff: "exponential"
  timeout: 10s

tests:
  - name: "Test with default retry settings"
    curl: "curl https://httpbin.org/status/503"
    retry_on_status: [500, 502, 503, 504]
    assertions:
      - status: 200  # Will fail after retries

  - name: "Test with custom retry settings"
    curl: "curl https://httpbin.org/status/200"
    retries: 3
    retry_delay: "500ms"
    retry_backoff: "linear"
    assertions:
      - status: 200

  - name: "Test with no retries"
    curl: "curl https://httpbin.org/get"
    retries: 0
    assertions:
      - status: 200
      - json_path: ".url == 'https://httpbin.org/get'"

  - name: "Test retry only on specific status codes"
    curl: "curl https://httpbin.org/status/200"
    retries: 3
    retry_on_status: [429, 503, 504]
    assertions:
      - status: 200

  - name: "Test exponential backoff"
    curl: "curl https://httpbin.org/delay/1"
    retries: 3
    retry_delay: "100ms"
    retry_backoff: "exponential"
    assertions:
      - status: 200
      - response_time: "< 5s"
